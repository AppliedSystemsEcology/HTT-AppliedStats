specs = ~ ground_cover * day_night
)
# Conduct pairwise comparisons
pairs(emm_means_interaction1)
# Alternatively, compare ground covers within each day_night level:
pairs(emm_means_interaction1, by = "day_night")
# compare ground covers within each day_night level
pairs(emm_means_interaction1, by = "day_night")
# post hoc analysis of interaction terms
# ground_cover:day_night
# Estimate marginal means for the interaction
emm_means_interaction1 <- emmeans(
object = mixed,
specs = ~ ground_cover * day_night
)
# compare ground covers within each day_night level
pairs(emm_means_interaction1, by = "day_night")
# below ground SEAREC
## mixed model with subplot as a random effect
## filtered to account for sensor dying early
mixed <- lmer(mean_temperature_c~ground_cover*julian_day*day_night+ (1|sub_plot), data = Temperature_below_SEAREC %>% filter(julian_day<237))
summary(mixed)
#anova
anova(mixed)
# pretty table HTML of model output
tab_model(mixed,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
title = "Mixed Linear Model Summary for SEAREC",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.p = "p-value",
digits = 3,
dv.labels = "Below-Ground Mean Temperature (C)",
pred.labels = c(
"Intercept",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Day/Night (Nighttime)",
"Ground Cover (Soil) x Julian Day",
"Ground Cover (Straw) x Julian Day",
"Ground Cover (Soil) x Day/Night (Nighttime)",
"Ground Cover (Straw) x Day/Night (Nighttime)",
"Julian Day x Day/Night (Nighttime)",
"Ground Cover (Soil) x Day/Night (Nighttime) x Julian Day",
"Ground Cover (Straw) x Day/Night (Nighttime) x Julian Day"
)
)
# pretty table HTML of model output
tab_model(mixed,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
show.df = TRUE,
col.order = c("est", "se", "ci", "stat", "df.error", "p"),
title = "Mixed Linear Model Summary for SEAREC",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.p = "p-value",
string.df = "DF",
string.stat = "T Statistic",
digits = 3,
dv.labels = "Below-Ground Mean Temperature (C)",
pred.labels = c(
"Intercept",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Day/Night (Nighttime)",
"Ground Cover (Soil) x Julian Day",
"Ground Cover (Straw) x Julian Day",
"Ground Cover (Soil) x Day/Night (Nighttime)",
"Ground Cover (Straw) x Day/Night (Nighttime)",
"Julian Day x Day/Night (Nighttime)",
"Ground Cover (Soil) x Day/Night (Nighttime) x Julian Day",
"Ground Cover (Straw) x Day/Night (Nighttime) x Julian Day"
)
)
#anova
anova(mixed)
# below ground SEAREC
## mixed model with subplot as a random effect
## filtered to account for sensor dying early
mixed <- lmer(mean_temperature_c~ground_cover*julian_day*day_night+ (1|sub_plot), data = Temperature_below_SEAREC %>% filter(julian_day<237))
summary(mixed)
# post hoc analysis of interaction terms
# ground_cover:day_night
# Estimate marginal means for the interaction
emm_means_interaction1 <- emmeans(
object = mixed,
specs = ~ ground_cover * day_night
)
# compare ground covers within each day_night level
pairs(emm_means_interaction1, by = "day_night")
# julian_day:day_night
# Estimate the slope of 'julian_day' for each level of 'day_night'
trends_output <- emtrends(
object = mixed,
specs = ~ day_night,
var = "julian_day"
)
comparison_of_slopes <- pairs(trends_output)
comparison_of_slopes
# Rock Springs(RS) model
# subset damage data for only Rock Springs
TomatoThripsDamage_RS <- TomatoThripsDamage %>%
subset(site == "RS")
# establish baseline at lowest level of damage
TomatoThripsDamage_RS$damage_rating_baseline <- relevel(TomatoThripsDamage_RS$damage_rating, ref = "0")
multinom_RS <- multinom(damage_rating_baseline~ground_cover+julian_day, data = TomatoThripsDamage_RS)
summary(multinom_RS)
# HTML table output of model
tab_model(multinom_RS,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
title = "Multinominal Logistic Regression Summary for Rock Springs",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.p = "p-value",
digits = 3,
dv.labels = "Damage Rating (baseline)",
pred.labels = c(
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"
)
)
# HTML table output of model
tab_model(multinom_RS,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
show.df = TRUE,
title = "Multinominal Logistic Regression Summary for Rock Springs",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.p = "p-value",
string.stat = "Z Statistic"
digits = 3,
# HTML table output of model
tab_model(multinom_RS,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
show.df = TRUE,
title = "Multinominal Logistic Regression Summary for Rock Springs",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.p = "p-value",
string.stat = "Z Statistic",
digits = 3,
dv.labels = "Damage Rating (baseline)",
pred.labels = c(
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"
)
)
?col.order()
?tab_model()
# HTML table output of model
tab_model(multinom_RS,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
show.df = TRUE,
show.ci = FALSE,
col.order = c("est", "se", "stat", "df.error", "response.level", "p"),
title = "Multinominal Logistic Regression Summary for Rock Springs",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.p = "p-value",
string.stat = "Z Statistic",
digits = 3,
dv.labels = "Damage Rating (baseline)",
pred.labels = c(
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"
)
)
# nice HTML table of model output
tab_model(multinom_SEAREC,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
show.df = TRUE,
show.ci = FALSE,
col.order = c("est", "se", "stat", "df.error", "response.level", "p"),
title = "Multinominal Logistic Regression Summary for SEAREC",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.stat = "Z Statistic",
string.p = "p-value",
digits = 3,
dv.labels = "Damage Rating (baseline)",
pred.labels = c(
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"
)
)
# HTML table output of model
tab_model(multinom_RS,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
show.df = TRUE,
show.ci = FALSE,
col.order = c("est", "se", "stat", "df.error", "response.level", "p"),
title = "Multinominal Logistic Regression Summary for Rock Springs",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.p = "p-value",
string.stat = "Z Statistic",
digits = 3,
dv.labels = "Damage Rating (baseline)",
pred.labels = c(
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"
)
)
# relative risk (or odds): the ratio of the probability of choosing one alternative outcome over the probability of choosing the baseline; the right-hand side linear equation exponentiated, meaning the exponentiated regression coefficients are relative risk rations for a unit change in the predictor variable
# exponentiated model coefficients
relriskRS <- as.data.frame(exp(coef(multinom_RS)))
# relative risk data frame as nice HTML table
tab_df(relriskRS,
title = "Relative Risk (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
tab_df(relriskRS,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
#multinomial logistic regression model
multinom_SEAREC <- multinom(damage_rating_baseline~ground_cover+julian_day, data = TomatoThripsDamage_SEAREC)
summary(multinom_SEAREC)
# relative risk data frame as nice HTML table
tab_df(relriskSEAREC,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
# nice HTML table of model output
tab_model(multinom_SEAREC,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
show.df = TRUE,
show.ci = FALSE,
col.order = c("est", "se", "stat", "df.error", "response.level", "p"),
title = "Multinominal Logistic Regression Summary for SEAREC",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.stat = "Z Statistic",
string.p = "p-value",
digits = 3,
dv.labels = "Damage Rating (baseline)",
pred.labels = c(
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"
)
)
# relative risk data frame as nice HTML table
tab_df(relriskRS,
show.rownames = TRUE,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
# relative risk data frame as nice HTML table
tab_df(relriskRS,
show.rownames = TRUE,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Response", "Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
# relative risk data frame as nice HTML table
tab_df(relriskRS,
show.rownames = TRUE,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
## repeat multinomial regression for SEAREC
# SEAREC model
# subset damage data for only Rock Springs
TomatoThripsDamage_SEAREC <- TomatoThripsDamage %>%
subset(site == "SEAREC")
# establish baseline at lowest level of damage
# putting baseline at "1" since there were no "0" ratings at SEAREC
TomatoThripsDamage_SEAREC$damage_rating_baseline <- relevel(TomatoThripsDamage_SEAREC$damage_rating, ref = "1")
#multinomial logistic regression model
multinom_SEAREC <- multinom(damage_rating_baseline~ground_cover+julian_day, data = TomatoThripsDamage_SEAREC)
summary(multinom_SEAREC)
# nice HTML table of model output
tab_model(multinom_SEAREC,
transform = NULL,
show.est = TRUE,
show.se = TRUE,
show.stat = TRUE,
show.df = TRUE,
show.ci = FALSE,
col.order = c("est", "se", "stat", "df.error", "response.level", "p"),
title = "Multinominal Logistic Regression Summary for SEAREC",
string.se = "SE",
p.style = "numeric",
string.ci = "CI (95%)",
string.pred = "Coefficient",
string.stat = "Z Statistic",
string.p = "p-value",
digits = 3,
dv.labels = "Damage Rating (baseline)",
pred.labels = c(
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day",
"Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"
)
)
# relative risk ratios
relriskSEAREC <- as.data.frame(exp(coef(multinom_SEAREC)))
# relative risk data frame as nice HTML table
tab_df(relriskSEAREC,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
# relative risk data frame as nice HTML table
tab_df(relriskSEAREC,
show.rownames = TRUE,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
summary(multinom_SEAREC)
relriskSEAREC
# Calculate the mean of the Julian day in your specific dataset
mean_jd <- mean(TomatoThripsDamage_SEAREC$julian_day)
# Create a centered Julian day variable
TomatoThripsDamage_SEAREC$julian_day_centered <- TomatoThripsDamage_SEAREC$julian_day - mean_jd
# Rerun the model with the centered variable
multinom_SEAREC_centered <- multinom(
formula = damage_rating_baseline ~ ground_cover + julian_day_centered,
data = TomatoThripsDamage_SEAREC
)
# Recalculate the RRRs
centered_rrr_values <- exp(summary(multinom_SEAREC_centered)$coefficients)
print(centered_rrr_values)
# relative risk data frame as nice HTML table
tab_df(centered_rrr_values,
show.rownames = TRUE,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
print(centered_rrr_values)
# Recalculate the RRRs
centered_rrr_values <- as.data.frame(exp(coef(multinom_SEAREC_centered)))
print(centered_rrr_values)
print(centered_rrr_values)
# relative risk data frame as nice HTML table
tab_df(centered_rrr_values,
show.rownames = TRUE,
title = "Relative Risk Ratio (Exponentiated Model Coefficients)",
col.header = c("Ground Cover (Fabric)",
"Ground Cover (Soil)",
"Ground Cover (Straw)",
"Julian Day"),
digits = 4,
)
# compare ground covers within each day_night level
pairs(emm_means_interaction1, by = "day_night")
# below ground SEAREC
## mixed model with subplot as a random effect
## filtered to account for sensor dying early
mixed <- lmer(mean_temperature_c~ground_cover*julian_day*day_night+ (1|sub_plot), data = Temperature_below_SEAREC %>% filter(julian_day<237))
# post hoc analysis of interaction terms
# ground_cover:day_night
# Estimate marginal means for the interaction
emm_means_interaction1 <- emmeans(
object = mixed,
specs = ~ ground_cover * day_night
)
# compare ground covers within each day_night level
pairs(emm_means_interaction1, by = "day_night")
comparison_of_slopes <- pairs(trends_output)
comparison_of_slopes
tab_df(as.data.frams(comparison_of_slopes))
tab_df(as.data.frame(comparison_of_slopes))
tab_df(as.data.frame(comparison_of_slopes),
digits = 4)
tab_df(trends_df,
col.header = c("Contrast", "Ground Cover", "Estimate", "SE", "DF", "T Ratio", "P Value"),
digits = 7,
p.style = "numeric"
)
# table
tab_df(as.data.frame(comparison_of_slopes),
digits = 4)
?emtrends()
